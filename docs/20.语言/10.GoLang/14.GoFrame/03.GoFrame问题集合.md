---
title: GoFrame问题集合
date: 2022-09-21 11:00:30
permalink: /language/go/5def12/
categories:
  - 语言
  - GoLang
  - GoFrame
tags:
  - GoLang
  - GoFrame
  - 问题集合
  - Web静态资源
---

## 前言

本文针对`gf 2.1.4`中使用中遇到的问题进行的记录。

<!-- more -->

<InArticleAdsense
    data-ad-client="ca-pub-1725717718088510"
    data-ad-slot="7426219401">
</InArticleAdsense>

## 资源

### 指定`web`资源路径

#### 结构目录

::: details 点击查看目录结构

```
.
├── Makefile
├── README.MD
├── api
│   └── v1
│       └── hello.go
├── go.mod
├── go.sum
├── hack
│   ├── config.yaml
│   ├── kit
│   └── plugin
├── internal
│   ├── cmd
│   │   └── cmd.go
│   ├── consts
│   │   └── consts.go
│   ├── controller
│   │   ├── admin
│   │   │   └── index.go
│   │   └── hello.go
│   ├── dao
│   ├── logic
│   ├── model
│   │   ├── do
│   │   └── entity
│   ├── packed
│   │   └── packed.go
│   ├── router
│   │   └── router.go
│   └── service
├── main.go
├── manifest
│   ├── config
│   │   └── config.yaml
│   ├── deploy
│   │   └── kustomize
│   │       ├── base
│   │       │   ├── deployment.yaml
│   │       │   ├── kustomization.yaml
│   │       │   └── service.yaml
│   │       └── overlays
│   │           └── develop
│   │               ├── configmap.yaml
│   │               ├── deployment.yaml
│   │               └── kustomization.yaml
│   └── docker
│       ├── Dockerfile
│       └── docker.sh
├── resource
│   ├── i18n
│   ├── public
│   │   ├── html
│   │   │   └── admin
│   │   │       ├── index.html
│   │   │       └── login.html
│   │   ├── plugin
│   │   └── resource
│   │       ├── css
│   │       │   └── admin
│   │       │       ├── 810.019038a6.css
│   │       │       ├── app.040a8d2a.css
│   │       │       └── loading.css
│   │       ├── image
│   │       │   └── admin
│   │       │       └── bgImg
│   │       │           └── lyfcy.jpg
│   │       └── js
│   │           ├── admin
│   │           │   ├── 810.7d77b430.js
│   │           │   └── app.a08365b1.js
│   │           └── vue
│   │               └── vue.global.js
│   └── template
└── utility
```

:::

1. 在`manifest/config/config.yaml`中的`server`结构下增加以下代码

``` yaml
# 以项目目录为根节点/
server:
  serverRoot: "/resource/public/resource"
viewer:
  # 指定web资源
  Paths: "resource/public/html"
  # 默认页面
  DefaultFile: "index.html"
  AutoEncode: true
```

2. `html`中引用文件；以引用`lyfcy.jpg`为例：`<img src="../image/admin/bgImg/lyfcy.jpg">`

### 配置文件

#### `web`页面渲染配置文件中的值

##### `Config`

访问默认的配置管理（`config.toml`）对象配置项。

使用方式：

``` html
{{.Config.配置项}}
```

##### `Cookie`

访问当前请求的 Cookie 对象参数值。

使用方式：

``` html
{{.Cookie.键名}}
```

##### `Session`

访问当前请求的 Session 对象参数值。

使用方式：

``` html
{{.Session.键名}}
```

##### `Query`

访问当前 Query String 中的请求参数值。

使用方式：

``` html
{{.Query.键名}}
```

##### `Form`

访问当前表单请求参数值。

使用方式：

``` html
{{.Form.键名}}
```

##### `Request`

访问当前请求参数值（不区分参数提交方式）。

使用方式：

``` html
{{.Request.键名}}
```


## `SQL`

### 模型使用链式操作

以`User`表为例，当我们需要接受前台传过来的时间参数时来讲解

我最开始的时候是按下面方法来写的

``` go
// 错误写法
sql := dao.User.Ctx(ctx)
if dateTime != "" {
  sql.WhereBetween("create_time",beginDateTime,endDateTime)
}
```

结果发现：当`dateTime`不为空的时候，`sql`也没有将条件附加上去，然后看了看[文档](https://goframe.org/pages/viewpage.action?pageId=1114373)发现一段话：

> 用户模型单例对象`user`可以重复使用，而不用担心被“污染”的问题。在这种链式安全的方式下，我们可以创建一个用户单例对象`user`，并且可以重复使用到后续的各种查询中。但是存在多个查询条件时，条件的叠加需要通过模型赋值操作`（m = m.xxx）`来实现。

所以猜测是否在模型对象情况下默认加上了`Safe`方法，于是改成了下面的方法通过了

``` go
// 正确写法
sql := dao.User.Ctx(ctx).Safe(false)
if dateTime != "" {
  sql.WhereBetween("create_time",beginDateTime,endDateTime)
}
```
